webpackJsonp([10],[function(e,t,n){var a;(function(i){a=function(e){var t=n(2);t.comment={$container:i("#container"),$comment_container:i("#commentlist"),streetTpl:i("#street").html(),nostreetTpl:i("#nostreet").html(),msg:{noselect:"未作选择",empty:"评论不能为空哦~",end:"已加载完毕",more:"点击加载更多",streetempty:"本社区暂无留言,快来留言吧！"},page:1,street:function(){var e=this;t.Getdata(t.url.street,{},function(t){var n=e.streetTpl.replace(/{(\w+)}/g,function(){return t.data[arguments[1]]});e.$container.prepend(n),e.render(t.data.id,g_param.type,1),e.comment(),e.selectstreet()},function(t){if(105==t.response)return e.$container.prepend(e.nostreetTpl),e.render(0,g_param.type,1),e.selectstreet(),!1})},render:function(e,n,a){var o=this;1==a&&o.$comment_container.html("<li>"+t.loading+"</li>"),t.Getdata(t.url.commentlist,{relationId:e,type:n,page:a},function(t){var n=t.data.list,t=n.data,c=t.length,r="",s="",l=Math.ceil(n.total/n.per_page);if(1==a&&o.$comment_container.html(""),1==a&&0==c)r='<li class="empty"><em class="icon icon-empty"></em><p class="txt">'+o.msg.streetempty+"</p></li>";else if(c>0){for(var m=0;m<c;m++)s=0!=e?'<a class="zan" href="javascript:void(0)"><span class="label"><em class="icon icon-liked"></em><i>'+t[m].zan+"</i></span></a>":"",r+='<li class="it" id="'+t[m].id+'"><p class="title"><span>'+t[m].member.relname+"</span><span>"+t[m].createdAt+"</span>"+s+'</p><p class="content"><a href="/mobile/comments/'+t[m].id+'">'+t[m].content+"</a></p></li>";r+='<li class="tips"><a id="more" href="javascript:void(0)">'+(a==l?o.msg.end:o.msg.more)+"</a></li>"}else r+='<li class="tips">'+o.msg.end+"</li>";i("#more").parent().remove(),o.$comment_container.append(r)})},comment:function(){var e=this;document.getElementById("comment-btn").addEventListener("touchstart",function(){if(!document.getElementById("comment-container")){i("body").append('<div id="comment-container"><p><textarea placeholder="期待更多有趣内容，请留下您的建议..."></textarea></p><p class="btn-b"><a id="comment-confirm" href="javascript:void(0)">确定</a></p><p class="btn-b"><a id="comment-close" href="javascript:void(0)">取消</a></p></div>');var n=i("#comment-container");document.getElementById("comment-confirm").addEventListener("touchstart",function(){var a=i.trim(n.find("textarea").val());a?t.Postdata(t.url.commentlist,{relationId:g_param.relationId,content:a,type:g_param.type},function(){i("body, html").css("overflow","initial"),e.page=1,e.render(g_param.relationId,g_param.type,e.page),n.removeClass("active"),n.find("textarea").val("")}):t.alertPop(e.msg.empty)}),document.getElementById("comment-close").addEventListener("touchstart",function(){n.removeClass("active")})}setTimeout(function(){i("#comment-container").addClass("active")},10),setTimeout(function(){i("body").scrollTop(0),i("body, html").css("overflow","hidden")},310)})},selectstreet:function(){document.getElementById("select-street").addEventListener("touchstart",function(){i("#comment-layer")[0]?t.showePop():t.Getdata(t.url.streetlist,{},function(e){for(var e=e.data.list,n='<ul id="comment-layer">',a=0;a<e.length;a++)n+='<li id="'+e[a].id+'"><label class="clearfix"><span>'+e[a].streetname+'</span><input class="checkbox hidden" name="streetname" type="radio" /><em class="icon icon-checkbox"></em></label></li>';n+='<li id="no"><label class="clearfix"><span>暂不选择</span><input class="checkbox hidden" name="streetname" type="radio" /><em class="icon icon-checkbox"></em></label></li>',n+="</ul>",t.popLayer(n),i(".pop-layer").append('<p class="btn-b"><a id="confirm" href="javascript:void(0)">确定</a></p></div>'),i("body").append(n),i("body").css("overflow","hidden")})})},init:function(){var e=this;"street"===g_param.pagetype&&e.street(),i(document).on("click","#confirm",function(){var n=!1,a="";i("#comment-layer").find("li").each(function(){var e=i(this),t=e.find("input");if(t.is(":checked"))return n=!0,a=e.attr("id"),!1}),n?"no"==a?(t.hidePop(),i("body").css("overflow","auto")):t.Postdata(t.url.set,{Street_id:a},function(){location.reload()}):t.alertPop(e.msg.noselect)}).on("click","#more",function(){e.page++,i(this).html(t.loading),e.render(g_param.relationId,g_param.type,e.page)}).on("click",".zan",function(){var e=i(this),n=e.parents("li").attr("id");t.Postdata(t.url.zan,{id:n},function(){e.find("i").text(parseInt(e.find("i").text())+1)})})}},t.comment.init()}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1))}]);